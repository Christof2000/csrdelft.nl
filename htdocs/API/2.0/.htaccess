# Enable CORS
Header always set Access-Control-Allow-Origin "*"
Header always set Access-Control-Allow-Headers "Accept, Origin, Content-Type, Authorization, X-Csr-Authorization"
Header always set Access-Control-Allow-Methods "PUT, GET, POST, DELETE, OPTIONS"

RewriteEngine On

# Pass the Authorization header
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule .* - [e=HTTP_AUTHORIZATION:%1]

# Preflight response
RewriteCond %{REQUEST_METHOD} OPTIONS
RewriteRule ^(.*)$ $1 [R=200,L]

RewriteRule ^auth/authorize$ authorize.php [L]
RewriteRule ^auth/token$ token.php [L]
RewriteRule ^leden/([0-9a-z]*)$ api.php?cat=leden&id=$1 [L]
RewriteRule ^leden$ api.php?cat=leden [L]
RewriteRule ^agenda$ api.php?cat=agenda [QSA,L]
RewriteRule ^([a-z]*)/([0-9]*)/aanmelden api.php?cat=$1&id=$2&action=aanmelden [L]
RewriteRule ^([a-z]*)/([0-9]*)/afmelden api.php?cat=$1&id=$2&action=afmelden [L]
