/*!
 * csrdelft.js
 * 
 * @author C.S.R. Delft <pubcie@csrdelft.nl>
 * @author P.W.G. Brussee <brussee@live.nl>
 * 
 * De stek layout uit 2014
 */
var shiftPressed;var ctrlPressed;var orderDraw=true;$(document).ready(function(){init_keyPressed();init_timeago();init_dataTables()});function init_timeago(){$.timeago.settings.strings={prefiprefixAgo:"",prefixFromNow:"sinds",suffixAgo:"geleden",suffixFromNow:"",seconds:"minder dan een minuut",minute:"1 minuut",minutes:"%d minuten",hour:"1 uur",hours:"%d uur",day:"een dag",days:"%d dagen",month:"een maand",months:"%d maanden",year:"een jaar",years:"%d jaar",wordSeparator:" ",numbers:[]}}function init_keyPressed(){$(window).on("keyup",function(a){$(window).one("keydown",function(b){if(b.which===16){shiftPressed=true}else{if(b.which===17){ctrlPressed=true}}});if(a.which===16){shiftPressed=false}else{if(a.which===17){ctrlPressed=false}}});$(window).trigger("keyup")}function init_dataTables(){$.extend($.fn.dataTable.defaults,{dom:"frtpli",lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"Alles"]],});$.fn.dataTable.ext.search.push(groupExpandCollapseDraw)}function multiSelect(b){if(b.hasClass("group")){if(b.nextUntil(".group").not(".selected").length!==0){if(!shiftPressed){b.siblings(".selected").removeClass("selected")}b.nextUntil(".group").addClass("selected")}else{b.nextUntil(".group").removeClass("selected")}}else{if(!b.children(":first").hasClass("dataTables_empty")){b.toggleClass("selected");if(shiftPressed){var a=b.hasClass("selected");if(b.prevAll(".selected").not(".group").length!==0){b.prevUntil(".selected").not(".group").each(function(){$(this).toggleClass("selected",a)})}else{if(b.nextAll(".selected").not(".group").length!==0){b.nextUntil(".selected").not(".group").each(function(){$(this).toggleClass("selected",a)})}}}}}}function setGroupByColumn(a,b){console.log(b);a.attr("groupByColumn",b);if(b===false){a.removeClass("collapseAll");a.data("expandedGroups",[]);a.data("collapsedGroups",[])}}function getGroupByColumn(a){var b=parseInt(a.attr("groupByColumn"));if(isNaN(b)){return false}return b}function groupByColumn(f,b){if(orderDraw){orderDraw=false;return}var c=$(b.nTable);var a=c.DataTable();var d=getGroupByColumn(c);if(ctrlPressed){a.column(d).visible(true);d=a.order()[0][0];a.column(d).visible(false)}else{if(!shiftPressed){a.column(d).visible(true);d=false}}setGroupByColumn(c,d)}function groupByColumnDraw(h,b){var d=$(b.nTable);var a=d.DataTable();var g=getGroupByColumn(d);if(g===false){return}var f=a.rows({page:"current"}).nodes();var c=null;a.column(g,{page:"current"}).data().each(function(l,k){if(c!==l){var m=b.aoColumns.length-1;var e;var j='<tr class="group expanded"><td class="details-control"></td><td colspan="'+m+'">'+l+"</td></tr>";$(f).eq(k).before(j);c=l}})}function groupExpandCollapse(d,c,g){var b=c.parent().parent();var a=b.data("expandedGroups");var f=b.data("collapsedGroups");if(ctrlPressed){b.toggleClass("collapseAll");a=[];f=[]}else{c.toggleClass("expanded")}var e=g.next().html();if(b.hasClass("collapseAll")){if(c.hasClass("expanded")){a.push(e)}else{a=$.grep(a,function(h){return h!==e})}if(a.length<1){b.removeClass("collapseAll")}}else{if(c.hasClass("expanded")){f=$.grep(f,function(h){return h!==e})}else{f.push(e)}}b.data("expandedGroups",a);b.data("collapsedGroups",f);orderDraw=true;d.draw()}function groupExpandCollapseDraw(c,f,a){var d=$(c.nTable);var e=getGroupByColumn(d);if(e===false){return true}var g=f[e];if(d.hasClass("collapseAll")){var b=d.data("expandedGroups");if($.inArray(g,b)>-1){return true}return false}else{var h=d.data("collapsedGroups");if($.inArray(g,h)>-1){return false}return true}}function childRow(c,e){var b=e.closest("tr");if(b.hasClass("group")){groupExpandCollapse(c,b,e);return}var d=c.row(b);if(d.child.isShown()){if(b.hasClass("loading")){}else{b.removeClass("expanded");var a=b.next().children(":first").children(":first");a.slideUp(400,function(){d.child.hide()})}}else{d.child('<div class="innerDetails" style="display: none;"></div>').show();b.addClass("expanded loading");var a=b.next().addClass("childrow").children(":first").children(":first");$.ajax({url:e.attr("href")}).done(function(f){if(d.child.isShown()){b.removeClass("loading");a.html(f).slideDown()}})}};