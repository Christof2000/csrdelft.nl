var http=new XMLHttpRequest();function preload(a){$(a).each(function(){$("<img/>")[0].src=this})}preload(["http://plaetjes.csrdelft.nl/layout/loading-fb.gif","http://plaetjes.csrdelft.nl/layout/loading-arrows.gif","http://plaetjes.csrdelft.nl/layout/loading_bar_black.gif"]);$(document).ready(function(){init_scroll_fixed();init_key_pressed();init_dropzone();init()});function init(){init_links();init_buttons();init_forms();init_timeago();init_hoverIntents();init_lazy_images()}function undo_inline_css(){$("*").removeAttr("style width border cellSpacing cellPadding")}function init_dropzone(){try{Dropzone.autoDiscover=false}catch(a){}}function init_timeago(){try{$.timeago.settings.strings={prefiprefixAgo:"",prefixFromNow:"sinds",suffixAgo:"geleden",suffixFromNow:"",seconds:"minder dan een minuut",minute:"1 minuut",minutes:"%d minuten",hour:"1 uur",hours:"%d uur",day:"een dag",days:"%d dagen",month:"een maand",months:"%d maanden",year:"een jaar",years:"%d jaar",wordSeparator:" ",numbers:[]};$("abbr.timeago").timeago()}catch(a){}}var bShiftPressed=false;var bCtrlPressed=false;var bAltPressed=false;var bMetaPressed=false;function init_key_pressed(){$(window).on("keyup",function(a){$(window).one("keydown",function(b){key_pressed_update(b)});key_pressed_update(a)});$(window).trigger("keyup")}function key_pressed_update(a){bShiftPressed=(a.shiftKey?true:false);bCtrlPressed=(a.ctrlKey?true:false);bAltPressed=(a.altKey?true:false);bMetaPressed=(a.metaKey?true:false)}function init_lazy_images(){$("div.ubb_img_loading").each(function(){var a=$(document.createElement("IMG"));a.error(function(){$(this).attr("title","Afbeelding bestaat niet of is niet toegankelijk!");$(this).attr("src","http://plaetjes.csrdelft.nl/famfamfam/picture_error.png");$(this).css("width","16px");$(this).css("height","16px");$(this).removeClass("ubb_img_loading").addClass("ubb_img")});a.addClass("ubb_img");a.attr("alt",$(this).attr("title"));a.attr("style",$(this).attr("style"));a.attr("src",$(this).attr("src"));$(this).html(a);a.on("load",function(){$(this).parent().replaceWith($(this))})})}function init_scroll_fixed(){$(".scroll-fix").each(function(){$(this).attr("yfix",$(this).offset().top);$(this).parent().height($(this).height());$(this).parent().width($(this).width())});$(window).scroll(function(){$(".scroll-fix").each(function(){var b=$(this).parent().offset().top-$(window).scrollTop();var a=$(this).parent().offset().left-$(window).scrollLeft();if(b<=0){b=0}$(this).css({top:b,left:a})})})}function page_reload(){location.reload()}function init_buttons(){$("button.spoiler").unbind("click.spoiler");$("button.spoiler").bind("click.spoiler",function(c){c.preventDefault();var a=$(this);var b=a.next("div.spoiler-content");if(a.html()==="Toon verklapper"){a.html("Verberg verklapper")}else{a.html("Toon verklapper")}b.toggle(800,"easeInOutCubic",function(d){})});$("button.popup").unbind("click.popup");$("button.popup").bind("click.popup",function(a){popup_open()});$("button.post").unbind("click.post");$("button.post").bind("click.post",knop_post);$("button.get").unbind("click.get");$("button.get").bind("click.get",knop_get)}function init_hoverIntents(){$(".hoverIntent").hoverIntent({over:function(){$(this).find(".hoverIntentContent").fadeIn()},out:function(){$(this).find(".hoverIntentContent").fadeOut()},timeout:250})}function init_links(){$("a.popup").unbind("click.popup");$("a.popup").bind("click.popup",popup_open);$("a.post").unbind("click.post");$("a.post").bind("click.post",knop_post);$("a.get").unbind("click.get");$("a.get").bind("click.get",knop_get)}function knop_ajax(e,b){if(e.hasClass("confirm")&&!confirm(e.attr("title")+".\n\nWeet u het zeker?")){popup_close();return false}if(e.hasClass("prompt")){var d=e.attr("postdata");d=d.split("=");var f=prompt(d[0],d[1]);if(!f){return false}e.attr("postdata",encodeURIComponent(d[0])+"="+encodeURIComponent(f))}var c=e;var a=dom_update;if(e.hasClass("popup")){c=false;a=popup_open}if(e.hasClass("ReloadPage")){a=page_reload}ajax_request(b,e.attr("href"),e.attr("postdata"),c,a,alert)}function knop_post(a){a.preventDefault();if($(this).hasClass("range")){if(a.target.tagName.toUpperCase()==="INPUT"){taken_select_range(a)}else{taken_submit_range(a)}return false}knop_ajax($(this),"POST");return false}function knop_get(a){a.preventDefault();knop_ajax($(this),"GET");return false}function popup_open(a){if(a){$("#popup").html(a);init();$("#popup").show();$("#popup-background").css("background-image","none");$("#popup input:visible:first").focus()}else{$("#popup-background").css("background-image",'url("http://plaetjes.csrdelft.nl/layout/loading_bar_black.gif")');$("#popup").hide();$("#popup").html("")}$("#popup-background").fadeIn()}function popup_close(){$("#popup").hide();$("#popup").html("");$("#popup-background").fadeOut()}function init_forms(){$(".Formulier").each(function(){var b=$(this).attr("id");if(b){var a="form_ready_"+b;a=a.split("-").join("_");if(typeof window[a]==="function"){window[a]()}}$(this).unbind("submit.enter");$(this).bind("submit.enter",form_submit);$(this).unbind("keyup.esc");$(this).bind("keyup.esc",form_esc)});$(".submit").unbind("click.submit");$(".submit").bind("click.submit",form_submit);$(".reset").unbind("click.reset");$(".reset").bind("click.reset",form_reset);$(".cancel").unbind("click.cancel");$(".cancel").bind("click.cancel",form_cancel);$(".InlineFormToggle").unbind("click.toggle");$(".InlineFormToggle").bind("click.toggle",form_toggle);$(".SubmitChange").unbind("change.change");$(".SubmitChange").bind("change.change",form_submit)}function form_ischanged(a){var b=false;$(a).find(".FormElement").each(function(){if($(this).is("input:radio")){if($(this).is(":checked")&&$(this).attr("origvalue")!==$(this).val()){b=true;return false}}else{if($(this).is("input:checkbox")){if($(this).is(":checked")!==($(this).attr("origvalue")==="1")){b=true;return false}}else{if($(this).val()!==$(this).attr("origvalue")){b=true;return false}}}});return b}function form_replace_action(c){var b=$(c.target).closest("form");var a=$(c.target).closest("a.knop").attr("href");b.attr("action",a)}function toggle_vertical_align(a){if($(a).css("vertical-align")!=="top"){$(a).css("vertical-align","top")}else{$(a).css("vertical-align","bottom")}}function toggle_inline_none(a){$(a).css("display",$(a).css("display")==="none"?"inline":"none")}function form_inline_toggle(a){$(a).find(".InputField").each(function(){toggle_inline_none($(this))});$(a).find(".FormButtons").each(function(){toggle_inline_none($(this))});$(a).find(".InlineFormToggle").toggle();$(a).find(".FormElement").focus()}function form_toggle(b){var a=$(this).closest("form");b.preventDefault();form_inline_toggle(a);return false}function form_esc(a){if(a.keyCode===27){form_cancel(a)}}function form_submit(c){var b=$(this).closest("form");if(b.hasClass("PreventUnchanged")&&!form_ischanged(b)){c.preventDefault();alert("Geen wijzigingen");return false}if(b.hasClass("popup")||b.hasClass("InlineForm")){c.preventDefault();var d=false;if(b.hasClass("InlineForm")){d=b}var a=dom_update;if(b.hasClass("ReloadPage")){a=page_reload}var e=new FormData(b.get(0));ajax_request("POST",b.attr("action"),e,d,a,alert,function(){if(b.hasClass("SubmitReset")){form_reset(c,b)}});return false}b.unbind("submit");b.submit();return true}function form_reset(b,a){if(!a){a=$(this).closest("form");b.preventDefault()}a.find(".FormElement").each(function(){var c=$(this).attr("origvalue");if(c){$(this).val(c)}});return false}function form_cancel(b){var a=$(this).closest("form");if(a.hasClass("InlineForm")){b.preventDefault();form_inline_toggle(a);return false}if($(this).hasClass("post")){b.preventDefault();knop_post(b);return false}if(a.hasClass("popup")){b.preventDefault();if(!form_ischanged(a)||confirm("Sluiten zonder wijzigingen op te slaan?")){popup_close()}return false}return true}function dom_update(b){b=$.trim(b);if(b.substring(0,9)==="<!DOCTYPE"){alert("response error");document.write(b)}var a=$.parseHTML(b);$(a).each(function(){var e=$(this).attr("id");if(e==="popup-content"){popup_open(b)}else{popup_close()}var c=$("#"+e);if(c.length===1){if($(this).hasClass("remove")){c.effect("puff",{},400,remove)}else{c.replaceWith($(this)).effect("highlight")}}else{var d=$(this).attr("parentid");if(d){$(this).prependTo("#"+d).effect("highlight")}else{$(this).prependTo("#maalcie-tabel tbody:visible:first").effect("highlight")}}init()})}function remove(){$(this).remove()}function ajax_request(e,b,d,a,j,f,c){if(a){$(a).replaceWith('<img title="'+b+'" src="http://plaetjes.csrdelft.nl/layout/loading-arrows.gif" />');a='img[title="'+b+'"]'}else{popup_open()}var i="application/x-www-form-urlencoded; charset=UTF-8";var g=true;if(d instanceof FormData){i=false;g=false}var h=$.ajax({type:e,dataType:false,contentType:i,processData:g,url:b,cache:false,data:d});h.done(function(l,m,k){j(l)});h.fail(function(k,m,l){if(l===""){l="Nog bezig met laden!"}if(a){$(a).replaceWith('<img title="'+l+'" src="http://plaetjes.csrdelft.nl/famfamfam/cancel.png" />')}else{popup_close()}if(f){f(l)}});h.always(function(){if(c){c()}})}function ketzer_ajax(a,b){$(b+" .aanmelddata").html('Aangemeld:<br /><img src="http://plaetjes.csrdelft.nl/layout/loading-arrows.gif" />');var c=$.ajax({type:"GET",cache:false,url:a,data:""});c.done(function(f,g,e){var d=$.parseHTML(f);$(".ubb_maaltijd").each(function(){if($(this).attr("id")===$(d).attr("id")){$(this).replaceWith(f)}})});c.fail(function(d,f,e){$(b+" .aanmelddata").html('<span style="color: red; font-weight: bold;">Error: </span>'+e);alert(e)});return true}function peiling_bevestig_stem(c){var b=$("input[name=optie]:checked",c).val();var a=$("#label"+b).text();if(confirm("Bevestig uw stem:\n\n"+a+"\n\n")){$(c).submit()}}function selectText(e){var c=document;var d=c.getElementById(e);var a;var b;if(c.body.createTextRange){a=c.body.createTextRange();a.moveToElementText(d);a.select()}else{if(window.getSelection){b=window.getSelection();a=c.createRange();a.selectNodeContents(d);b.removeAllRanges();b.addRange(a)}}}function vergrootTextarea(b,a){jQuery("#"+b).animate({height:"+="+a*30},800,function(){})}function applyUBB(a,c){var b=$.ajax({type:"POST",cache:false,url:"/tools/ubb.php",data:"string="+encodeURIComponent(a)});b.done(function(e,f,d){$(c).html(e);init()})}function youtubeDisplay(a){$("#youtube"+a).html('<object width="640" height="480"><param name="movie" value="http://www.youtube.com/v/'+a+'&autoplay=1&fs=1"></param><param name="allowFullScreen" value="true"></param><embed src="http://www.youtube.com/v/'+a+'&autoplay=1&fs=1" type="application/x-shockwave-flash" wmode="transparent" width="640" height="480" allowfullscreen="true"></embed></object>');return false}function readableFileSize(c){var a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];var b=0;while(c>=1024){c/=1024;++b}c=c/1;return c.toFixed(1)+" "+a[b]}function importAgenda(b){var a=$.ajax({type:"POST",cache:false,url:"/agenda/courant/",data:""});a.done(function(d,e,c){document.getElementById(b).value+="\n"+d})}function ubbPreview(c,b){var a=document.getElementById(c).value;if(a.length!==""){var d=document.getElementById(b);applyUBB(a,d);d.style.display="block"}};