$(document).ready(function(){window.addEventListener("mousedown",startDrag,false);window.addEventListener("mouseup",stopDrag,false)});var dragobjectID=false;var oldX;var oldY;function startDrag(b){b=b||window.event;var a=b.target.tagName.toUpperCase();var c=$(b.target).css("overflow");if(a==="SELECT"||a==="INPUT"||a==="TEXTAREA"||c==="auto"||c==="scroll"){return}dragobjectID=$(b.target).attr("id");if(typeof dragobjectID==="undefined"||dragobjectID===false||!$("#"+dragobjectID).hasClass("dragobject")){dragobjectID=$(b.target).closest(".dragobject").attr("id")}if(typeof dragobjectID!=="undefined"&&dragobjectID!==false){oldX=mouseX(b);oldY=mouseY(b);window.addEventListener("mousemove",mouseMoveHandler,true)}else{dragobjectID=false}dragged=false}function stopDrag(a){if(!dragobjectID){return}window.removeEventListener("mousemove",mouseMoveHandler,true);if(dragged){$.post("/tools/dragobject.php",{id:dragobjectID,coords:{left:dragobjLeft(),top:dragobjTop()}});dragged=false}dragobjectID=false}function mouseMoveHandler(c){if(!dragobjectID){return}dragged=true;c=c||window.event;var d=mouseX(c);var b=mouseY(c);var a=$("#"+dragobjectID);if(a.hasClass("dragvertical")){a.scrollTop(a.scrollTop()+oldY-b);dragged=false}else{if(a.hasClass("draghorizontal")){a.scrollLeft(a.scrollLeft()+oldX-d);dragged=false}else{a.css({top:(dragobjTop()+b-oldY)+"px",left:(dragobjLeft()+d-oldX)+"px"})}}oldX=d;oldY=b}function docScrollLeft(){return(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}function docScrollTop(){return(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}function mouseX(a){if(a.pageX){return a.pageX}if(a.clientX){return a.clientX+docScrollLeft()}return null}function mouseY(a){if(a.pageY){return a.pageY}if(a.clientY){return a.clientY+docScrollTop()}return null}function dragobjLeft(){return $("#"+dragobjectID).offset().left-docScrollLeft()}function dragobjTop(){return $("#"+dragobjectID).offset().top-docScrollTop()};