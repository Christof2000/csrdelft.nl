var saveConcept;jQuery(document).ready(function(d){saveConcept=function(){d("#forumConcept").fadeOut();if(d("#forumBericht").val()!==d("#forumBericht").attr("origvalue")){d.post("/forum/concept",{forumBericht:d("#forumBericht").val()},function(){d("#forumBericht").attr("origvalue",d("#forumBericht").val())})}};d(window).unload(function(){saveConcept()});var a=function(){if(d("#forumBericht").val()!==d("#forumBericht").attr("origvalue")){d("#forumConcept").fadeIn()}};var c;d("#forumBericht").focusin(function(){c=setInterval(a,1000)});d("#forumBericht").focusout(function(){clearInterval(c)});d("#forumBericht").each(function(){d(this).wrap('<div id="meldingen"></div>');if(d(this).hasClass("extern")){d("#meldingen").prepend('<div id="extern_melding"><strong>Openbaar forum</strong><br />Voor iedereen leesbaar, doorzoekbaar door zoekmachines.<br />Zet [prive] en [/prive] om uw persoonlijke contactgegevens in het bericht.</div>')}}).keyup(function(f){var e=d(this);if(f.keyCode==13){if(/\[.*\]/.test(e.val())){ubbPreview("forumBericht","berichtPreview");if(d("#ubb_melding").length==0){e.before('<div id="ubb_melding">UBB gevonden:<br /> controleer het voorbeeld.</div>');d("#ubb_melding").click(function(){d("#ubbhulpverhaal").toggle()})}}}if(d("#ketzer_melding").length==0&&/ketzer/.test(e.val())){e.before('<div id="ketzer_melding">Ketzer hebben?<br /><a href="/actueel/groepen/Ketzers" target="_blank">&raquo; Maak er zelf een aan.</a></div>')}});d(".togglePasfoto").each(function(){d(this).click(function(){var f=d(this).attr("id").substr(1).split("-");var e=d("#p"+f[1]);if(e.html()==""){e.html('<img src="/tools/pasfoto/'+f[0]+'.png" class="lidfoto" />')}if(e.hasClass("verborgen")){e.toggleClass("verborgen");d(this).html("")}})});d("td.auteur").hoverIntent(function(){d(this).find("a.forummodknop").fadeIn()},function(){d(this).find("a.forummodknop").fadeOut()});if(!window.location.hash&&window.location.pathname.substr(0,15)=="/forum/reactie/"){var b=parseInt(window.location.pathname.substr(15),10);window.location.hash="#"+b}});var orig=null;function togglePasfotos(a,b){if(orig!=null){b.innerHTML=orig;orig=null}else{http.abort();http.open("GET","/tools/pasfotos.php?string="+escape(a),true);http.onreadystatechange=function(){if(http.readyState==4){orig=b.innerHTML;b.innerHTML=http.responseText}};http.send(null)}}var bewerkDiv=null;var bewerkDivInnerHTML=null;function forumBewerken(a){http.abort();http.open("POST","/forum/tekst/"+a,true);http.onreadystatechange=function(){if(http.readyState==4){if(document.getElementById("forumEditForm")){restorePost()}bewerkDiv=document.getElementById("post"+a);bewerkDivInnerHTML=bewerkDiv.innerHTML;bewerkForm='<form id="forumEditForm" class="Formulier InlineForm" action="/forum/bewerken/'+a+'" method="post">';bewerkForm+="<h3>Bericht bewerken</h3>Als u dingen aanpast zet er dan even bij w&aacute;t u aanpast! Gebruik bijvoorbeeld [s]...[/s]<br />";bewerkForm+='<div id="bewerkPreview" class="preview forumBericht"></div>';bewerkForm+='<textarea name="forumBericht" id="forumBewerkBericht" class="tekst" rows="8"></textarea>';bewerkForm+='Reden van bewerking: <input type="text" name="reden" id="forumBewerkReden"/><br /><br />';bewerkForm+='<a class="knop float-right" onclick="$(\'#ubbhulpverhaal\').toggle();" title="Opmaakhulp weergeven">Opmaak</a>';bewerkForm+='<a class="knop float-right" onclick="vergrootTextarea(\'forumBewerkBericht\', 10)" title="Vergroot het invoerveld"><div class="arrows">&uarr;&darr;</div>&nbsp;&nbsp;&nbsp;&nbsp;</a>';bewerkForm+='<input type="button" value="Opslaan" onclick="submitPost();" /> <input type="button" value="Voorbeeld" onclick="ubbPreview(\'forumBewerkBericht\', \'bewerkPreview\');" /> <input type="button" value="Annuleren" onclick="restorePost();" />';bewerkForm+="</form>";bewerkDiv.innerHTML=bewerkForm;document.getElementById("forumBewerkBericht").value=http.responseText;$("#forumBewerkBericht").autosize();document.getElementById("forumBericht").disabled=true;document.getElementById("forumOpslaan").disabled=true;document.getElementById("forumVoorbeeld").disabled=true}};http.send(null);return false}function forumCiteren(a){http.abort();http.open("POST","/forum/citeren/"+a,true);http.onreadystatechange=function(){if(http.readyState==4){document.getElementById("forumBericht").value+=http.responseText;$(window).scrollTo("#reageren")}};http.send(null);return false}function restorePost(){bewerkDiv.innerHTML=bewerkDivInnerHTML;document.getElementById("forumBericht").disabled=false;document.getElementById("forumOpslaan").disabled=false;document.getElementById("forumVoorbeeld").disabled=false}function submitPost(){var b=$("#forumEditForm");var a=$.ajax({type:"POST",cache:false,url:b.attr("action"),data:b.serialize()});a.done(function(d,e,c){restorePost();dom_update(d)});a.fail(function(c,e,d){alert(e)})};