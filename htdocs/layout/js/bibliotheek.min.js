jQuery(document).ready(function(g){jQuery("#boeken tr:odd").addClass("odd");var h=jQuery("#boekencatalogus").dataTable({oLanguage:{sZeroRecords:"Geen boeken gevonden",sInfoEmtpy:"Geen boeken gevonden",sSearch:"Zoeken:",oPaginate:{sFirst:"Eerste",sPrevious:"Vorige",sNext:"Volgende",sLast:"Laatste"}},bServerSide:true,sAjaxSource:"/communicatie/bibliotheek/catalogusdata",fnServerParams:function(i){i.push({name:"sEigenaarFilter",value:g("span.filter.actief").attr("id")});i.push({name:"sView",value:g("input[name=boekstatus]").is(":checked")})},iDisplayLength:30,bInfo:false,bLengthChange:false,bStateSave:true,iCookieDuration:60*15,fnStateSaveCallback:function(i,j){j+=',"sEigenaarFilter": "'+g("span.filter.actief").attr("id")+'"';j+=',"sView": '+g("input[name=boekstatus]").is(":checked");init_hoverIntents();return j},fnStateLoadCallback:function(i,k){var j=["alle","csr","leden","eigen","geleend"];if(g.inArray(k.sEigenaarFilter,j)==-1){k.sEigenaarFilter="csr"}g("span.filter").removeClass("actief").addClass("button");g("span.filter#"+k.sEigenaarFilter).removeClass("button").addClass("actief");g("input[name=boekstatus]").attr("checked",k.sView);return true},aaSorting:[[0,"asc"]],sPaginationType:"full_numbers",aoColumns:b()});function b(){var i;if(g("#boekencatalogus").hasClass("lid")){i={aoKolommen:[{sType:"html"},{sType:"html"},{sType:"html"},{sType:"html",sWidth:"40px"},{sType:"html",sWidth:"125px",bVisible:false},{sType:"html",sWidth:"125px",bVisible:false},{sType:"html",sWidth:"100px",bVisible:false}]}}else{i={aoKolommen:[{sType:"html",sWidth:"400px"},{sType:"html"},{sType:"html",sWidth:"300px"}]}}return i.aoKolommen}g("span.filter").click(function(){g("span.filter").removeClass("actief").addClass("button");g(this).removeClass("button").addClass("actief");h.fnDraw()});g("input#boekstatus").click(function(){var i=g("#boekencatalogus").dataTable();var j=g("input[name=boekstatus]").is(":checked");i.fnSetColumnVis(6,j,false);i.fnSetColumnVis(5,j,false);i.fnSetColumnVis(4,j,true)});biebCodeVakvuller();function e(i){return i.authors?i.authors.join(", "):""}function c(i){return i.publishedDate?i.publishedDate.substring(0,4):""}function f(j){var i="";if(j.industryIdentifiers&&j.industryIdentifiers[1]&&j.industryIdentifiers[1].type=="ISBN_13"){i=j.industryIdentifiers[1].identifier}return i}function d(i){var j={nl:"Nederlands",en:"Engels",fr:"Frans",de:"Duits",bg:"Bulgaars",es:"Spaans",cs:"Tsjechisch",da:"Deens",et:"Ests",el:"Grieks",ga:"Iers",it:"Italiaans",lv:"Lets",lt:"Litouws",hu:"Hongaars",mt:"Maltees",pl:"Pools",pt:"Portugees",ro:"Roemeens",sk:"Slowaaks",sl:"Sloveens",fi:"Fins",sv:"Zweeds"};return j[i.language]?j[i.language]:i.language}g("#boekzoeker").autocomplete("https://www.googleapis.com/books/v1/volumes",{dataType:"jsonp",parse:function(m){var l=new Array();m=m.items;for(var j=0;j<m.length;j++){var k=m[j].volumeInfo;l[j]={data:k,value:k.title,result:k.title+" "+e(k)}}return l},formatItem:function(l,j,m){var k='<div title="titel: '+l.title+"\nAuteur: "+e(l)+"\nPagina's: "+l.pageCount+"\nTaal: "+d(l)+"\nISBN: "+f(l)+"\nUitgeverij: "+l.publisher+"\nUitgavejaar: "+c(l)+'">';k+=l.title+"<br /><i>"+e(l)+"</i>";k+="</div>";return k},formatResult:function(i){return i.title+" "+e(i)},extraParams:{limit:"",fields:"items(volumeInfo(authors,industryIdentifiers,language,pageCount,publishedDate,publisher,title))",key:"AIzaSyC7zu4-25xbizddFWuIbn107WTTPr37jos",maxResults:25,qq:1},minChars:7,delay:1000,max:25}).result(function(i,k,j){g("#field_titel").val(k.title);g("#field_auteur").val(e(k));g("#field_paginas").val(k.pageCount);g("#field_taal").val(d(k));g("#field_isbn").val(f(k));g("#field_uitgeverij").val(k.publisher);g("#field_uitgavejaar").val(c(k))}).keyup(function(i){var j=g(this).val().length;if(j>0&&j<7){g(this).css("background-color","#ffcc96")}else{g(this).css("background-color","white")}});var a={dataType:"json",parse:function(i){return i},formatItem:function(k,j,l){return'Ga naar: <a href="/communicatie/bibliotheek/boek/'+k.id+'" target="_blank">'+k.titel+"</a>"},clickFire:true,max:20};g("#field_titel").autocomplete("/communicatie/bibliotheek/autocomplete/titel",a).result(function(i,j){window.open("/communicatie/bibliotheek/boek/"+j.id)});g(".blok .InputField input,.blok .InputField textarea,.blok .InputField select").each(function(j,i){g(this).after('<div class="melding"></div>').after(g('<a class="knop opslaan">Opslaan</a>').mousedown(function(){var k=i.id.substring(6);var m=g("#"+i.id).val();var l=jQuery(".boek").attr("id");var n="id="+k+"&"+k+"="+m;jQuery.ajax({type:"POST",url:"/communicatie/bibliotheek/bewerkboek/"+l,data:n,cache:false,dataType:"json",success:function(o){var p=g("#"+k);if(o.value){g("#"+i.id).val(o.value);p.removeClass("metFouten").addClass("opgeslagen");window.setTimeout(function(){p.removeClass("opgeslagen")},3000);if(i.id.substring(6,11)=="lener"){location.reload()}}else{p.removeClass("opgeslagen").addClass("metFouten")}p.find(".melding").html(o.melding).show();g("#"+i.id).removeClass("nonsavededits")}})})).keydown(function(){g(this).addClass("nonsavededits")}).change(function(){if(g(this).val().length==0){g(this).addClass("leeg")}else{g(this).removeClass("leeg")}}).change()})});function biebCodeVakvuller(){var a=$('<a class="knop genereer" title="Biebcode invullen">Genereer</a>').mousedown(function(b){b.preventDefault();$("#field_code").val($("#field_rubriek").val()+"."+$("#field_auteur").val().substring(0,3).toLowerCase()).focus()});$("#field_code").after(a)};