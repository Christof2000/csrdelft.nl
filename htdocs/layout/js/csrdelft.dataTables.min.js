/*!
 * csrdelft.dataTables.js
 * 
 * @author P.W.G. Brussee <brussee@live.nl>
 * 
 * Group by & multi-select capabilities.
 */
var bOrderDraw=false;$(document).ready(function(){fnInitDataTables()});function fnInitDataTables(){$.extend($.fn.dataTable.defaults,{dom:"frtpli",lengthMenu:[[10,15,25,50,100,-1],[10,15,25,50,100,"Alles"]]});$.fn.dataTable.ext.search.push(fnGroupExpandCollapseDraw)}function fnMultiSelect(f){if(f.children(":first").hasClass("dataTables_empty")){return}if(bShiftPressed){var d=f.prevAll(":not(.group)");var h=f.prevUntil(".selected").not(".group");var e=h.length;var a=f.nextAll(":not(.group)");var c=f.nextUntil(".selected").not(".group");var g=c.length;if(h.length===d.length){g=-1}if(c.length===a.length){e=-1}if(e<g){h.addClass("selected")}else{if(e>g){c.addClass("selected")}}if(f.hasClass("group")){f.nextUntil(".group").addClass("selected")}else{f.addClass("selected")}}else{if(bCtrlPressed){if(f.hasClass("group")){var c=f.nextUntil(".group");var b=c.filter(".selected");if(b.length===c.length){c.removeClass("selected")}else{c.addClass("selected")}}else{f.toggleClass("selected")}}else{f.siblings(".selected").removeClass("selected");if(f.hasClass("group")){f.nextUntil(".group").addClass("selected")}else{f.addClass("selected")}}}document.getSelection().removeAllRanges()}function fnGetGroupByColumn(a){var b=parseInt(a.attr("groupByColumn"));if(isNaN(b)){return false}return b}function fnGroupByColumn(g,b){if(bOrderDraw||!bCtrlPressed){return}var c=$(b.nTable);var f=c.DataTable();var d=fnGetGroupByColumn(c);var a=f.order();f.column(d).visible(true);d=a[0][0];f.column(d).visible(false);c.attr("groupByColumn",d);c.data("collapsedGroups",[]);c.find("thead tr:first").addClass("expanded").children(":first").addClass("details-control");b.aaSortingFixed=a.slice();bOrderDraw=true;f.draw()}function fnGroupByColumnDraw(h,f){if(bOrderDraw){bOrderDraw=false;return}var k=$(f.nTable);var a=fnGetGroupByColumn(k);if(a===false){return}var i=k.data("collapsedGroups").slice();var d=f.aoColumns.length-1;var b;if(f.aiDisplay.length>0){var c=k.DataTable();var l=$(c.rows({page:"current"}).nodes());var j=null;c.column(a,{page:"current"}).data().each(function(m,e){if(j!==m){while(i.length>0&&i[0].localeCompare(m)<0){b=$('<tr class="group"><td class="details-control"></td><td colspan="'+d+'">'+i[0]+"</td></tr>").data("groupData",i[0]);l.eq(e).before(b);i.shift()}b=$('<tr class="group expanded"><td class="details-control"></td><td colspan="'+d+'">'+m+"</td></tr>").data("groupData",m);l.eq(e).before(b);j=m}})}var g=k.children("tbody:first");i.forEach(function(e){b=$('<tr class="group"><td class="details-control"></td><td colspan="'+d+'">'+e+"</td></tr>").data("groupData",e);g.append(b)})}function fnGroupExpandCollapse(c,a,b){var e=a.data("collapsedGroups");b.toggleClass("expanded");var d=b.data("groupData");if(b.hasClass("expanded")){e=$.grep(e,function(f){return f!==d})}else{e.push(d)}a.data("collapsedGroups",e.sort());bCtrlPressed=false;c.draw()}function fnGroupExpandCollapseAll(e,b,d){var c=fnGetGroupByColumn(b);if(c===false){return}d.toggleClass("expanded");var f=[];if(!d.hasClass("expanded")){var a=null;e.column(c).data().each(function(h,g){if(a!==h){f.push(h);a=h}})}b.data("collapsedGroups",f);e.draw()}function fnGroupExpandCollapseDraw(b,e,a){var c=$(b.nTable);var d=fnGetGroupByColumn(c);if(d===false){return true}var f=e[d];var g=c.data("collapsedGroups");if($.inArray(f,g)>-1){return false}return true}function fnChildRow(c,e){var b=e.closest("tr");var d=c.row(b);if(d.child.isShown()){if(b.hasClass("loading")){}else{b.removeClass("expanded");var a=b.next().children(":first").children(":first");a.slideUp(400,function(){d.child.hide()})}}else{d.child('<div class="innerDetails verborgen"></div>').show();b.addClass("expanded loading");var a=b.next().addClass("childrow").children(":first").children(":first");$.ajax({url:e.data("detailSource")}).done(function(f){if(d.child.isShown()){b.removeClass("loading");a.html(f).slideDown()}})}};